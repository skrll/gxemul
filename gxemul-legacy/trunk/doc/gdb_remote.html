<html><head><title>Gavare's eXperimental Emulator:&nbsp;&nbsp;&nbsp;GDB remote serial protocol connection</title>
<meta name="robots" content="noarchive,nofollow,noindex"></head>
<body bgcolor="#f8f8f8" text="#000000" link="#4040f0" vlink="#404040" alink="#ff0000">
<table border=0 width=100% bgcolor="#d0d0d0"><tr>
<td width=100% align=center valign=center><table border=0 width=100%><tr>
<td align="left" valign=center bgcolor="#d0efff"><font color="#6060e0" size="6">
<b>Gavare's eXperimental Emulator:</b></font><br>
<font color="#000000" size="6"><b>GDB remote serial protocol connection</b>
</font></td></tr></table></td></tr></table><p>

<!--

$Id: gdb_remote.html,v 1.10 2006-05-05 05:32:13 debug Exp $

Copyright (C) 2006  Anders Gavare.  All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:

1. Redistributions of source code must retain the above copyright
   notice, this list of conditions and the following disclaimer.
2. Redistributions in binary form must reproduce the above copyright
   notice, this list of conditions and the following disclaimer in the
   documentation and/or other materials provided with the distribution.
3. The name of the author may not be used to endorse or promote products
   derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS ``AS IS'' AND
ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE
FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
SUCH DAMAGE.

-->

<a href="./">Back to the index</a>

<p><br>
<h2>GDB remote serial protocol connection</h2>

<p>
<ul>
  <li><a href="#intro">Introduction</a>
  <li><a href="#prerequisites">Prerequisites</a>
  <li><a href="#example">Example session</a>
</ul>






<p><br>
<a name="intro"></a>
<h3>Introduction:</h3>

Starting with release 0.4.0, GXemul has (very rudimentary) GDB serial 
protocol support. This means that you can start up GDB, or a front-end 
program which in turn uses GDB, and connect it to a running GXemul 
instance.

<p>The GDB front-end I use in this example is the <a 
href="http://www.gnu.org/software/ddd/">Data Display Debugger (DDD)</a>.

<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
<a href="20060504-gdb-64bit-mips.png"><img src="20060504-gdb-64bit-mips_small.png"></a>

<p>The screenshot above shows DDD connected to GXemul, running the Hello 
World demo program compiled for mips64-unknown-elf, on a FreeBSD/amd64 host.






<p><br>
<a name="prerequisites"></a>
<h3>Prerequisites:</h3>

<ul>
  <li>Build and install GDB for your target. You should use the same
	configuration as you did when you compiled your compiler (e.g.
	mips64-unknown-elf). Assuming you use <tt>~/crossdev</tt> for all
	your cross-development tools:<pre>
	# <b>wget <a href="http://ftp.gnu.org/gnu/gdb/gdb-6.4.tar.gz">http://ftp.gnu.org/gnu/gdb/gdb-6.4.tar.gz</a></b>
	# <b>tar zxf gdb-6.4.tar.gz</b>
	# <b>cd gdb-6.4</b>
	# <b>./configure --prefix=$HOME/crossdev --target=mips64-unknown-elf</b>
	# <b>gmake install</b>
</pre>
	Remember to include <tt>~/crossdev/bin</tt> in your PATH.
  <p>
  <li>Optionally, but highly recommended:  Install a front-end for GDB, such 
	as DDD. In FreeBSD, this is done by:<pre>
	# <b>pkg_add -r ddd</b>
</pre>
	Other operating systems that have DDD available as a pre-compiled
	package have similar methods of installing it; otherwise you could
	try compiling DDD from source.
</ul>

You can still run a bare GDB session without a GUI front-end if you like.





<p><br>
<a name="example"></a>
<h3>Example session:</h3>

<ol>
  <li>Start up GXemul, and tell it to wait for an incoming GDB connection
	on a certain port:<pre>
	# <b>gxemul -x -E testmips -G 10000 hello_mips</b>

</pre>
  <p>
  <li>Start the DDD, using a GDB configured for this specific target,
	and also give the name of the binary/kernel. (This binary
	should have been compiled with <tt>-g</tt>.)<pre>
	# <b>ddd --debugger mips64-unknown-elf-gdb hello_mips</b>

</pre>
  <p>
  <li>At the <tt>(gdb)</tt> prompt in DDD, type:<pre>
	(gdb) <b>target remote localhost:10000</b>

</pre>
  <p>
  <li>Press F9 (Continue) to start. Press ESC when you wish to interrupt.
	You can also use F5 (Step) to single-step one instruction at a time.
</ol>



<p><br><b><u>Notes:</u><b>

<p>
<ul>
	<li>The remote GDB functionality in GXemul is quite hack-ish, very
		unstable, very slow, and does not support any fancy features
		such as breakpoints or watchpoints yet.
	<li>For 64-bit MIPS targets, you might have to fiddle with
		MIPS-related GDB settings, to make GDB send correct commands
		to GXemul. Otherwise, GDB only sends the lowest 32 bits
		of memory addresses, which is incorrect.
	<li>When remote-debugging PowerPC targets using DDD, you might have to
		press F9 <i>twice</i> to get it to start. I am not sure why.
</ul>

</p>


<p><br>


</body>
</html>
