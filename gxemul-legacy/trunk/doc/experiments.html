<html>
<head><title>mips64emul documentation: Experimenting with mips64emul</title>
</head>
<body bgcolor="#ffffff" text="#000000" link="#4040f0" vlink="#404040" alink="#ff0000">
<p>
<table width="100%">
  <tr><td width="100%" bgcolor="#808070"><font color="#ffffe0" size="6">
  <b>mips64emul documentation: Experimenting with mips64emul</b></font></td></tr>
</table>
<p>
<!-- The first 10 lines are cut away by the homepage updating script.  -->


<!--

$Id: experiments.html,v 1.43 2005-03-01 09:35:36 debug Exp $

Copyright (C) 2003-2005  Anders Gavare.  All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:

1. Redistributions of source code must retain the above copyright
   notice, this list of conditions and the following disclaimer.
2. Redistributions in binary form must reproduce the above copyright
   notice, this list of conditions and the following disclaimer in the
   documentation and/or other materials provided with the distribution.
3. The name of the author may not be used to endorse or promote products
   derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS ``AS IS'' AND
ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE
FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
SUCH DAMAGE.

-->

<a href="./">Back to the index</a>

<p><br>
<h2>Experimenting with mips64emul</h2>

<p>
<ul>
  <li><a href="#hello">Hello world</a>
  <li><a href="#expdevices">Experimental devices</a>
  <li><a href="#experiments">Experiments with other kernels and guest OSes</a>
</ul>






<p><br>
<a name="hello"></a>
<h3>Hello world:</h3>

You might want to use the emulator to develop programs on your own,
not just run precompiled kernels such as NetBSD. To get started, I recommend
that you do two things:

<p>
<ul>
  <li>Build and install a cross-compiler for MIPS.
  <li>Compile this hello world program, and run it in the emulator.
</ul>

<p>
The emulator has several modes where it doesn't emulate any real machine.
It can either run in "bare" mode, where no devices are included by default
(just the CPU), or in a "test" mode where some simple devices are 
emulated.

<p>
<table border="0"><tr><td width="40">&nbsp;</td><td>
<pre>
<font color=#f00000>/*  Hello world for mips64emul  */

/*  Note: The cast to a signed int causes the address to be sign-extended
    correctly to 0xffffffffb00000xx when compiled in 64-bit mode  */
</font><font color=#a0a0a0>#define	PUTCHAR_ADDRESS		((signed int)0xb0000000)
#define	HALT_ADDRESS		((signed int)0xb0000010)

</font><font color=#c000c0>void </font><font color=#000000><a name="printchar">printchar</a>(</font><font color=#c000c0>char </font><font color=#000000>ch)
{
	*((</font><font color=#c000c0>volatile unsigned char </font><font color=#000000>*) PUTCHAR_ADDRESS) = ch;
}

</font><font color=#c000c0>void </font><font color=#000000><a name="halt">halt</a>(</font><font color=#c000c0>void</font><font color=#000000>)
{
	*((</font><font color=#c000c0>volatile unsigned char </font><font color=#000000>*) HALT_ADDRESS) = 0;
}

</font><font color=#c000c0>void </font><font color=#000000><a name="printstr">printstr</a>(</font><font color=#c000c0>char </font><font color=#000000>*s)
{
	</font><font color=#c000c0>while </font><font color=#000000>(*s)
		printchar(*s++);
}

</font><font color=#c000c0>void </font><font color=#000000>f(</font><font color=#c000c0>void</font><font color=#000000>)
{
	printstr(</font><font color=#00c000>"Hello world\n"</font><font color=#000000>);
	halt();
}
</font></pre>
</td></tr></table>

This hello world program is available here as well:
<a href="hello_mips.c">hello_mips.c</a>
<p>
I recommend that you build a GCC cross compiler for the
<b>mips64-unknown-elf</b> target, and install it. Other compilers could
work too, but GCC is good because of its portability. Then try to compile
the hello world program:
<pre>
	$ <b>mips64-unknown-elf-gcc -O2 hello_mips.c -mips4 -mabi=64 -c</b>
	$ <b>mips64-unknown-elf-ld -Ttext 0xa800000000030000 -e f hello_mips.o -o hello_mips --oformat=elf64-bigmips</b>
	$ <b>file hello_mips</b>
	hello_mips: ELF 64-bit MSB mips-4 executable, MIPS R3000_BE, version 1 (SYSV), statically linked, not stripped
	$ <b>./mips64emul -q -E testmips hello_mips</b>
	Hello world

	$ <b>mips64-unknown-elf-gcc -O2 hello_mips.c -c</b>
	$ <b>mips64-unknown-elf-ld -Ttext 0x80030000 -e f hello_mips.o -o hello_mips</b>
	$ <b>file hello_mips</b>
	hello_mips: ELF 32-bit MSB mips-3 executable, MIPS R3000_BE, version 1 (SYSV), statically linked, not stripped
	$ <b>./mips64emul -q -E testmips hello_mips</b>
	Hello world
</pre>

<p>
As you can see above, a GCC configured for mips64-unknown-elf can produce
both 64-bit and 32-bit binaries. If you don't want to run the entire
Hello World program, but want to single-step through the execution to
learn more about how MIPS programs run, then add -V to the command line:

<p>
<pre>
	$ <b>./mips64emul -V -E testmips hello_mips</b>
	..
	mips64emul&gt; <b>r</b>
	cpu0:    pc = a800000000030078    <f>
	cpu0:    hi = 0000000000000000    lo = 0000000000000000
	cpu0:    zr = 0000000000000000    at = 0000000000000000
	cpu0:    v0 = 0000000000000000    v1 = 0000000000000000
	..
	cpu0:    gp = a8000000000780c0    sp = ffffffffa0007f00
	cpu0:    fp = 0000000000000000    ra = 0000000000000000
	mips64emul&gt; <b>s 15</b>
	&lt;f&gt;
	a800000000030078: 67bdfff0      daddiu  sp,sp,-16
	a80000000003007c: 3c04a800      lui     a0,0xa800
	a800000000030080: 3c010003      lui     at,0x3
	a800000000030084: 64840000      daddiu  a0,a0,0
	a800000000030088: 642100b8      daddiu  at,at,184
	a80000000003008c: 0004203c      dsll32  a0,a0,0
	a800000000030090: 0081202d      daddu   a0,a0,at
	a800000000030094: ffbf0000      sd      ra,0(sp)  [0xffffffffa0007ef0, data=0x0000000000000000]
	a800000000030098: 0c00c00a      jal     0xa800000000030028 &lt;printstr&gt;
	a80000000003009c: 00000000 (d)  nop
	  &lt;printstr("Hello world\n",0,0,0,..)&gt;
	&lt;printstr&gt;
	a800000000030028: 67bdfff0      daddiu  sp,sp,-16
	a80000000003002c: ffb00000      sd      s0,0(sp)  [0xffffffffa0007ee0, data=0x0000000000000000]
	a800000000030030: ffbf0008      sd      ra,8(sp)  [0xffffffffa0007ee8, data=0xa8000000000300a0]
	a800000000030034: 90820000      lbu     v0,0(a0)  [0xa8000000000300b8 = $LC0, data=0x48]
	a800000000030038: 00021600      sll     v0,v0,24
	mips64emul&gt; <b>print v0</b>
	v0 = 0x0000000048000000
	mips64emul&gt; <b><blink>_</blink></b>
</pre>

<p>
The syntax of the single-step debugger shouldn't be too hard to grasp.
Type 's' to single-step one instruction. Just pressing enter after that
will repeat the 's' command. Type 'quit' to quit.

<p>
Hopefully this is enough to get you inspired. :-)



<p><br>
<h4>Hello World for mips64emul's PPC mode</h4>

mips64emul also has an experimental PowerPC emulation mode (which is only 
enabled if --enable-ppc is supplied as a configure option).
<a href="hello_ppc.c">hello_ppc.c</a> is similar to hello_mips.c, but 
should be compiled and run as follows:
<p>
<pre>
	$ <b>ppc-unknown-elf-gcc -O2 hello_ppc.c -c</b>
	$ <b>ppc-unknown-elf-ld -e f hello_ppc.o -o hello_ppc</b>
	$ <b>file hello_ppc</b>
	hello_ppc: ELF 32-bit MSB executable, PowerPC or cisco 4500,
	  version 1 (SYSV), statically linked, not stripped
	$ <b>./mips64emul -q -E testppc hello_ppc</b>
	Hello world
</pre>

<p>
[&nbsp;2005-02-18: I haven't yet been able to build a GCC for ppc64 (only the
binutils toolchain), because the gcc sources seem to include Linux header files 
that aren't present on my FreeBSD system. 32-bit PPC works ok, though.&nbsp;]






<p><br>
<a name="expdevices"></a>
<h3>Experimental devices:</h3>

The "test" MIPS machine has the following experimental devices:

<p>
<center><table border="0" width="80%">

  <tr>
    <td align="left" valign="top" width="200">
	<b>cons:</b>
	<p>This is a simple console device, for writing
	characters to the controlling terminal.
	<p>Source code:&nbsp;&nbsp;<font color="#0000f0">devices/dev_cons.c</font>
	<br>Default physical address:&nbsp&nbsp;<font color="#0000f0">0x10000000</font>
    </td>
    <td align="left" valign="top" width="25">&nbsp;</td>
    <td align="left" valign="top">
	<table border="0">
	  <tr>
	    <td align="left" valign="top"><i><u>Offset:</u></i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
	    <td align="left" valign="top"><i><u>Effect:</u></i></td>
	  </tr>
	  <tr>
	    <td align="left" valign="top">0x0000</td>
	    <td align="left" valign="top">
		Read: <b>getchar()</b> (non-blocking)<br>
		Write: <b>putchar(ch)</b></td>
	  </tr>
	  <tr>
	    <td align="left" valign="top">0x0010</td>
	    <td align="left" valign="top">Read or write: <b>halt()</b><br>
		(Useful for exiting the emulator.)</td>
	  </tr>
	</table>
    </td>
  </tr>

  <tr height="15">
    <td height="15">&nbsp;</td>
  </tr>

  <tr>
    <td align="left" valign="top">
	<b>mp:</b>
	<p>This device controls the behaviour of CPUs in an emulated
	multi-processor system.
	<p>Source code:&nbsp;&nbsp;<font color="#0000f0">devices/dev_mp.c</font>
	<br>Default physical address:&nbsp&nbsp;<font color="#0000f0">0x11000000</font>
    </td>
    <td></td>
    <td align="left" valign="top">
	<table border="0">
	  <tr>
	    <td align="left" valign="top"><i><u>Offset:</u></i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
	    <td align="left" valign="top"><i><u>Effect:</u></i></td>
	  </tr>
	  <tr>
	    <td align="left" valign="top">0x0000</td>
	    <td align="left" valign="top">Read: <b>whoami()</b>.
		Returns the id of the CPU doing the read.</td>
	  </tr>
	  <tr>
	    <td align="left" valign="top">0x0010</td>
	    <td align="left" valign="top">Read: <b>ncpus()</b>.
		Returns the number of CPUs in the system.</td>
	  </tr>
	  <tr>
	    <td align="left" valign="top">0x0020</td>
	    <td align="left" valign="top">Write: <b>startupcpu(i)</b>.
		Starts CPU i. It begins execution at the address
		set by a write to startupaddr (see below).</td>
	  </tr>
	  <tr>
	    <td align="left" valign="top">0x0030</td>
	    <td align="left" valign="top">Write: <b>startupaddr(addr)</b>.
		Sets the starting address for CPUs.</td>
	  </tr>
	  <tr>
	    <td align="left" valign="top">0x0040</td>
	    <td align="left" valign="top">Write: <b>pause_addr(addr)</b>.
		Sets the pause address. (TODO: This is not
		used anymore?)</td>
	  </tr>
	  <tr>
	    <td align="left" valign="top">0x0050</td>
	    <td align="left" valign="top">Write: <b>pause_cpu(i)</b>.
		Stops all CPUs <i>except</i> CPU i.</td>
	  </tr>
	  <tr>
	    <td align="left" valign="top">0x0060</td>
	    <td align="left" valign="top">Write: <b>unpause_cpu(i)</b>.
		Unpauses all CPUs <i>except</i> CPU i.</td>
	  </tr>
	  <tr>
	    <td align="left" valign="top">0x0070</td>
	    <td align="left" valign="top">Write: <b>startupstack(addr)</b>.
		Sets the startup stack address. (CPUs started with
		startupcpu() above will have their stack pointer
		set to this value.)</td>
	  </tr>
	  <tr>
	    <td align="left" valign="top">0x0080</td>
	    <td align="left" valign="top">Read: <b>hardware_random()</b>.
		This produces a "random" number.</td>
	  </tr>
	  <tr>
	    <td align="left" valign="top">0x0090</td>
	    <td align="left" valign="top">Read: <b>memory()</b>.
		Returns the number of bytes of RAM in the system.</td>
	  </tr>
	</table>
    </td>
  </tr>

  <tr height="15">
    <td height="15">&nbsp;</td>
  </tr>

  <tr>
    <td align="left" valign="top">
	<b>fb:</b>
	<p>A simple linear framebuffer, for graphics output.
	640 x 480 pixels, 3 bytes per pixel (red, green, blue, 8 bits each).
	<p>Source code:&nbsp;&nbsp;<font color="#0000f0">devices/dev_fb.c</font>
	<br>Default physical address:&nbsp&nbsp;<font color="#0000f0">0x12000000</font>
    </td>
    <td></td>
    <td align="left" valign="top">
	<table border="0">
	  <tr>
	    <td align="left" valign="top"><i><u>Offset:</u></i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
	    <td align="left" valign="top"><i><u>Effect:</u></i></td>
	  </tr>
	  <tr>
	    <td align="left" valign="top">...</td>
	    <td align="left" valign="top">Read: read pixel values.
		<br>Write: write pixel values.</td>
	  </tr>
	</table>
    </td>
  </tr>

</table></center>

<p>
While these devices may resemble real-world hardware, they are 
intentionally made simpler to use. (An exception is the framebuffer;
some machines actually have simple linear framebuffers like this.)

<p>
If the physical address is 0x10000000, then for MIPS that means that it 
can be accessed at virtual address 0xffffffffb0000000. (Actually it can be 
accessed at 0xffffffff90000000 too, but devices should usually be accessed
in a non-cached manner.)

<p>
(When using the PPC test machine, "testppc", the addresses are 
0x10000000, 0x11000000 etc., so no need to add any virtual displacement.)

<p>
The <b>mp</b> device is agnostic when it comes to 
word-length. For example, when reading offset 0x0000 of the <b>mp</b> 
device, you may use any kind of read (an 8-bit read will work just as well 
as a 64-bit read, although the value will be truncated to 8 bits in the 
first case).

<p>
The <b>cons</b> device should be accessed using 8-bit reads and writes.
Doing a getchar() (ie reading from offset 0x0000) returns 0x00 if no 
character was available.

<p>
On MIPS, the <b>cons</b> device is hardwired to interrupt 2 (the lowest 
hardware interrupt). Whenever a character is available, the interrupt is 
asserted. When there are no more available characters, the interrupt is 
deasserted. (Remember that the interrupt has to be enabled in the status
register of the system coprocessor.)






<p><br>
<a name="experiments"></a>
<h3>Experiments with other kernels and guest OSes:</h3>

<p>
Operating system kernels and other test programs can be downloaded from 
various places. Here are links to some of the kernels that I usually 
experiment with.

<p>
<font color="#ff0000">
NOTE: This is <i>not</i> a list of kernels that work in the emulator.
It is a list of kernels that I experiment with.
</font>

<p>
For more information about which of these that actually work, read the 
<a href="intro.html#guestos">section in the Introduction chapter</a>
that lists guest operating systems. If a system is not listed there, it 
probably doesn't work in mips64emul.

<p>
<ul>
  <li>DECstation:
    <ul>
      <li><a href="http://www.netbsd.org/Ports/pmax/">NetBSD/pmax</a>:
	<br><a href="ftp://ftp.netbsd.org/pub/NetBSD/NetBSD-2.0/pmax/binary/kernel/netbsd-INSTALL.gz">ftp://ftp.netbsd.org/pub/NetBSD/NetBSD-2.0/pmax/binary/kernel/netbsd-INSTALL.gz</a>
	<br><a href="ftp://ftp.netbsd.org/pub/NetBSD/NetBSD-2.0/pmax/binary/kernel/netbsd-INSTALL.symbols.gz">ftp://ftp.netbsd.org/pub/NetBSD/NetBSD-2.0/pmax/binary/kernel/netbsd-INSTALL.symbols.gz</a>
	<br>gunzip the files, and run the emulator with <b>-E dec -e 3max -q -N -XY2</b>
	for a graphical framebuffer console. Remove <b>-XY2</b> and <b>-N</b> to use serial (stdin/stdout) console.
	Read <a href="guestoses.html#netbsdinstall">this section</a> about how to install NetBSD/pmax onto a harddisk image.
      <p>
      <li><a href="http://www.openbsd.org/pmax.html">OpenBSD/pmax</a>:
	<br><a href="ftp://ftp.se.openbsd.org/pub/OpenBSD/2.8/pmax/bsd">ftp://ftp.se.openbsd.org/pub/OpenBSD/2.8/pmax/bsd</a>
	<br>This is an old OpenBSD kernel in a.out format. Try <b>-E dec -e 3max</b>.
	<br>Read <a href="guestoses.html#openbsdinstall">this section</a> about how to install OpenBSD/pmax onto a harddisk image.
	It's a bit more complicated than installing NetBSD/pmax, but might work.
      <p>
      <li>Linux for DECstation:
	<br>Here is a Debian package containing a Linux 2.4.26 kernel for
		DECstation which supports framebuffer!
	<br><a href="http://ftp.debian.org/debian/pool/main/k/kernel-patch-2.4.26-mips/kernel-image-2.4.26-r3k-kn02_2.4.26-0.040505.1_mipsel.deb">http://ftp.debian.org/debian/pool/main/k/kernel-patch-2.4.26-mips/
	<br>kernel-image-2.4.26-r3k-kn02_2.4.26-0.040505.1_mipsel.deb</a>
	<br>Run the following commands to extract the kernel:<pre>
	<b>ar x kernel-image-2.4.26-r3k-kn02_2.4.26-0.040505.1_mipsel.deb data.tar.gz</b>
	<b>tar xfzv data.tar.gz ./boot/vmlinux-2.4.26-r3k-kn02</b>
	<b>mv boot/vmlinux-* .; rmdir boot</b>
</pre>
	<br>To try with the framebuffer: <b>-E dec -e 3max -X vmlinux-2.4.26-r3k-kn02</b>
	<br>To try with serial console: <b>-E dec -e 3max -o 'console=ttyS3' vmlinux-2.4.26-r3k-kn02</b>
	<br>Read <a href="guestoses.html#declinux">this section</a> about how to run a Debian Linux install kernel.
	<br>Here are some older kernels (these don't support framebuffer, I think):
		<a href="http://www.xs4all.nl/~vhouten/mipsel/kernels.html">http://www.xs4all.nl/~vhouten/mipsel/kernels.html</a>
	<br>Note: Make sure you add <b>-CR4400</b> to the command line for
		R4000 kernels, as Linux doesn't autodetect CPU type at runtime.
      <p>
      <li>Sprite:
	<br>The Unix Heritage Society (TUHS, <a href="http://www.tuhs.org">www.tuhs.org</a>)
		has a copy of a harddisk image for a DECstation 5000/200:
		<a href="ftp://ftp.es.embnet.org/misc/TUHS/sprite/ds5000.bt">ftp://ftp.es.embnet.org/misc/TUHS/sprite/ds5000.bt</a>
			(MD5 (ds5000.bt) = ec84eeeb20fe77b758370d5e312e4a5e)
	<br>Read <a href="guestoses.html#sprite">this section</a> for more information
		about running this harddisk image in the emulator.
      <p>
      <li><a href="http://www-2.cs.cmu.edu/afs/cs/project/mach/public/www/mach.html">Mach</a>:
	<br>Important! Run <b>./configure --caches; make</b>
	<br>Download <a href="http://lost-contact.mit.edu/afs/athena/user/d/a/daveg/Info/Links/Mach/src/release/pmax.tar.Z">http://lost-contact.mit.edu/afs/athena/user/d/a/daveg/Info/Links/Mach/src/release/pmax.tar.Z</a>
	<br>tar xfvz pmax.tar.Z pmax_mach/special/mach.boot.MK83.STD+ANY
	<br><b>./mips64emul -E dec -e 3max -X pmax_mach/special/mach.boot.MK83.STD+ANY</b>
    </ul>
  </li>

  <p>

  <li>SGI:
    <ul>
      <li><a href="http://www.netbsd.org/Ports/sgimips/">NetBSD/sgimips</a>:
	<br><a href="ftp://ftp.netbsd.org/pub/NetBSD/NetBSD-2.0/sgimips/binary/kernel/netbsd-INSTALL32_IP3x.gz">ftp://ftp.netbsd.org/pub/NetBSD/NetBSD-2.0/sgimips/binary/kernel/netbsd-INSTALL32_IP3x.gz</a>
	<br><a href="ftp://ftp.netbsd.org/pub/NetBSD/NetBSD-2.0/sgimips/binary/kernel/netbsd-INSTALL32_IP3x.symbols.gz">ftp://ftp.netbsd.org/pub/NetBSD/NetBSD-2.0/sgimips/binary/kernel/netbsd-INSTALL32_IP3x.symbols.gz</a>
	<br>gunzip, and try running with <b>-E sgi -e ip32</b>.
	<br><a href="ftp://ftp.netbsd.org/pub/NetBSD/NetBSD-2.0/sgimips/binary/kernel/netbsd-INSTALL32_IP2x.gz">ftp://ftp.netbsd.org/pub/NetBSD/NetBSD-2.0/sgimips/binary/kernel/netbsd-INSTALL32_IP2x.gz</a>
	<br><a href="ftp://ftp.netbsd.org/pub/NetBSD/NetBSD-2.0/sgimips/binary/kernel/netbsd-INSTALL32_IP2x.symbols.gz">ftp://ftp.netbsd.org/pub/NetBSD/NetBSD-2.0/sgimips/binary/kernel/netbsd-INSTALL32_IP2x.symbols.gz</a>
	<br>gunzip, and try running with <b>-E sgi -e ip22</b> (or <b>-e ip24</b> or <b>-e ip20</b>).
      <p>
      <li>Linux/SGI:
	<br>Some kernels are available here: <a href="http://www.linux-mips.org/~glaurung/">http://www.linux-mips.org/~glaurung/</a>
	<br>Try running with <b>-E sgi -e ip32 -X</b> for a graphical framebuffer, or
		<b>-E sgi -e ip32 -o 'console=ttyS0'</b> for serial console.
	<br>Adding -b (bintrans) might work sometimes.
	<br>(You need to add <b>-CR5000</b> if you're trying to run
		a kernel compiled for R5000, because Linux
		doesn't autodetect CPU at runtime.)
	<br>Also: <a href="http://www.tal.org/~milang/o2/patches/vmlinux.ip32-2.6.10rc3-misc">http://www.tal.org/~milang/o2/patches/vmlinux.ip32-2.6.10rc3-misc</a>
	<br>Try <b>-E sgi -e ip32 -b -X -CR5000 vmlinux.ip32-2.6.10rc3-misc</b>.
	<br>And also some IP27 kernels:
		<a href="http://www.total-knowledge.com/progs/mips/kernels/vmlinux.ip27-20040428">http://www.total-knowledge.com/progs/mips/kernels/vmlinux.ip27-20040428</a>
		and
		<a href="http://www.total-knowledge.com/progs/mips/kernels/vmlinux.ip27-20040528.bz2">http://www.total-knowledge.com/progs/mips/kernels/vmlinux.ip27-20040528.bz2</a>
		(but unfortunately these lack symbols).
	<br>Try the IP27 kernels with <b>-E sgi -e ip27 -t</b>.
      <p>
      <li><a href="http://www.openbsd.org/sgi.html">OpenBSD/sgi</a>:
	<br>Snapshots can be found at <a href="ftp://ftp.OpenBSD.org/pub/OpenBSD/snapshots/sgi/">ftp://ftp.OpenBSD.org/pub/OpenBSD/snapshots/sgi/</a>.
	<br>Try <b>./mips64emul -b -E sgi -e ip32 bsd.rd</b>
      <p>
      <li><a href="http://www.freebsd.org/platforms/mips.html">FreeBSD/MIPS</a>:
		I don't think public binary snapshots are available yet.
      <p>
      <li>arcdiag:
	<br>The NetBSD people have also made available an "arcdiag" for SGI-IP22:
	<br><a href="ftp://ftp.netbsd.org/pub/NetBSD/arch/sgimips/arcdiag.ip22">ftp://ftp.netbsd.org/pub/NetBSD/arch/sgimips/arcdiag.ip22</a>
	<br>Try running <b>./mips64emul -E sgi -e ip22 arcdiag.ip22</b>.
    </ul>
  </li>

  <p>

  <li>ARC:
    <ul>
      <li><a href="http://www.netbsd.org/Ports/arc/">NetBSD/arc</a>:
	<br><a href="ftp://ftp.netbsd.org/pub/NetBSD/NetBSD-2.0/arc/binary/kernel/netbsd-RAMDISK.gz">ftp://ftp.netbsd.org/pub/NetBSD/NetBSD-2.0/arc/binary/kernel/netbsd-RAMDISK.gz</a>
	<br><a href="ftp://ftp.netbsd.org/pub/NetBSD/NetBSD-2.0/arc/binary/kernel/netbsd-RAMDISK.symbols.gz">ftp://ftp.netbsd.org/pub/NetBSD/NetBSD-2.0/arc/binary/kernel/netbsd-RAMDISK.symbols.gz</a>
	<br>gunzip, and try with <b>-E arc -e rd94</b>.
	<br>(You may also try other ARC models.)
	<br>Read <a href="guestoses.html#netbsdarcinstall">this section</a> about how
		to install NetBSD/arc onto a harddisk image.
      <p>
      <li><a href="http://www.openbsd.org/arc.html">OpenBSD/arc</a>:
	<br><a href="ftp://ftp.se.openbsd.org/pub/OpenBSD/2.3/arc/bsd.rd.elf">ftp://ftp.se.openbsd.org/pub/OpenBSD/2.3/arc/bsd.rd.elf</a>
	<br>Try running with <b>-X -E arc -e pica</b> or <b>-X -E arc -e tyne</b>.
	<br>Read <a href="guestoses.html#openbsdarcinstall">this section</a> about how
		to install OpenBSD/arc onto a harddisk image.
      <p>
      <li>Linux:
	<br><a href="ftp://ftp.linux-mips.org/pub/linux/mips/mipsel-linux/boot/vmlinux-m700-2.1.131.gz">ftp://ftp.linux-mips.org/pub/linux/mips/mipsel-linux/boot/vmlinux-m700-2.1.131.gz</a>
	<br>gunzip, and run with <b>-v -J -X -N -E arc -e m700</b> (Olivetti M700)
      <p>
      <li>Pandora:
	<br><a href="ftp://ftp.linux-mips.org/pub/linux/mips/ancient/milo/">ftp://ftp.linux-mips.org/pub/linux/mips/ancient/milo</a>/<a href="ftp://ftp.linux-mips.org/pub/linux/mips/ancient/milo/milo-0.27.1.tar.gz">milo-0.27.1.tar.gz</a>
	<br>A generic test/diagnostics program for ARC-based machines.
	<br>Run with <b>-E arc -e r94 milo-0.27.1/pandora</b>
      <p>
      <li>arcdiag:
	<br>Precompiled binary:<a href="ftp://ftp.netbsd.org/pub/NetBSD/arch/arc/arcdiag">ftp://ftp.netbsd.org/pub/NetBSD/arch/arc/arcdiag</a>
	<br>(alternative: <a href="http://www.sensi.org/~alec/mips/arcdiag">http://www.sensi.org/~alec/mips/arcdiag</a>)
	<br>A generic test/diagnostics program for ARC-based machines.
	<br>Run with <b>-E arc -e pica arcdiag</b> (or some other ARC mode).
	<br>Example arcdiag output (from real machines):
	<br><a href="http://mail-index.netbsd.org/port-arc/2000/10/18/0001.html">http://mail-index.netbsd.org/port-arc/2000/10/18/0001.html</a> (Olivetti M700-10)
	<br><a href="http://www.sensi.org/~alec/mips/arcdiag.txt">http://www.sensi.org/~alec/mips/arcdiag.txt</a> (PICA-61)
	<br><a href="http://mail-index.netbsd.org/port-arc/2000/10/14/0000.html">http://mail-index.netbsd.org/port-arc/2000/10/14/0000.html</a> (Deskstation Tyne)
	<br><a href="http://mail-index.netbsd.org/port-arc/2004/02/01/0001.html">http://mail-index.netbsd.org/port-arc/2004/02/01/0001.html</a> (NEC RISCserver 4200)
	<br><a href="http://mirror.aarnet.edu.au/pub/NetBSD/misc/chs/arcdiag.out">http://mirror.aarnet.edu.au/pub/NetBSD/misc/chs/arcdiag.out</a> (NEC-R96)
    </ul>
  </li>

  <p>

  <li>Playstation 2:
    <ul>
      <li><a href="http://www.netbsd.org/Ports/playstation2/">NetBSD/playstation2</a>:
	<br>NetBSD/playstation2 snapshot kernels are available here: (RAMDISK and GENERIC)
	<br><a href="ftp://ftp.NetBSD.org/pub/NetBSD/arch/playstation2/snapshot/20020327/installation/netbsd.gz">ftp://ftp.NetBSD.org/pub/NetBSD/arch/playstation2/snapshot/20020327/installation/netbsd.gz</a>
	<br><a href="ftp://ftp.NetBSD.org/pub/NetBSD/arch/playstation2/snapshot/20020327/binary/kernel/netbsd-GENERIC.gz">ftp://ftp.NetBSD.org/pub/NetBSD/arch/playstation2/snapshot/20020327/binary/kernel/netbsd-GENERIC.gz</a>
	<br>Try running with <b>-X -E playstation2</b>  (<b>-X</b> is required, for the framebuffer).

      <p>
      <li>Linux:
	<br>A Linux kernel (2.2.21-pre1-xr7) is available from
	<a href="http://playstation2-linux.com/projects/xrhino-kernel/">http://playstation2-linux.com/projects/xrhino-kernel/</a>
	<br>Try running with <b>-X -E playstation2</b>  (<b>-X</b> is required, for the framebuffer).
    </ul>
  </li>

</ul>

<p>
The following work even less than the ones listed above:

<p>
<ul>
  <li>Cobalt:
    <ul>
      <li><a href="http://www.netbsd.org/Ports/cobalt/">NetBSD/cobalt</a>:
	<br><a href="ftp://ftp.netbsd.org/pub/NetBSD/NetBSD-1.6.2/cobalt/binary/kernel/netbsd-GENERIC.gz">ftp://ftp.netbsd.org/pub/NetBSD/NetBSD-1.6.2/cobalt/binary/kernel/netbsd-GENERIC.gz</a>
	<br>gunzip, and run with <b>-E cobalt</b>
      <p>
      <li>Linux:
	<br><a href="http://people.debian.org/~pm/mips-cobalt/nfsroot/vmlinux_raq-2800.gz">http://people.debian.org/~pm/mips-cobalt/nfsroot/vmlinux_raq-2800.gz</a>
	<br>gunzip, and run with <b>-E cobalt</b>
    </ul>
  </li>

  <p>

  <li>Sony NeWS:
    <ul>
      <li><a href="http://www.netbsd.org/Ports/newsmips/">NetBSD/newsmips</a>:
	<br>A NetBSD/newsmips kernel and corresponding symbols are
		available here:
	<br><a href="ftp://ftp.netbsd.org/pub/NetBSD/NetBSD-2.0/newsmips/binary/kernel/netbsd-INSTALL.gz">ftp://ftp.netbsd.org/pub/NetBSD/NetBSD-2.0/newsmips/binary/kernel/netbsd-INSTALL.gz</a>
	<br><a href="ftp://ftp.netbsd.org/pub/NetBSD/NetBSD-2.0/newsmips/binary/kernel/netbsd-INSTALL.symbols.gz">ftp://ftp.netbsd.org/pub/NetBSD/NetBSD-2.0/newsmips/binary/kernel/netbsd-INSTALL.symbols.gz</a>
	<br>Try running with <b>-E sonynews</b>.
	<br>There's also a boot floppy available, but the emulator currently
		doesn't support booting from it:
	<br><a href="ftp://ftp.netbsd.org/pub/NetBSD/NetBSD-1.6/newsmips/installation/floppy/boot.fs">ftp://ftp.netbsd.org/pub/NetBSD/NetBSD-1.6/newsmips/installation/floppy/boot.fs</a>
    </ul>
  </li>

  <p>

  <li>HPCmips:
    <ul>
      <li><a href="http://www.netbsd.org/Ports/hpcmips/">NetBSD/hpcmips</a>:
	<br><a href="ftp://ftp.netbsd.org/pub/NetBSD/NetBSD-2.0/hpcmips/binary/kernel/netbsd-GENERIC.gz">ftp://ftp.netbsd.org/pub/NetBSD/NetBSD-2.0/hpcmips/binary/kernel/netbsd-GENERIC.gz</a>
	<br>Try <b>./mips64emul -X -b -E hpc -e e105 netbsd-GENERIC</b>
      <p>
      <li>Linux for BE300: <a href="http://www.linux4.be/2004/linux4be20040908.zip">http://www.linux4.be/2004/linux4be20040908.zip</a>
	<br>Try <b>./mips64emul -X -b -E hpc -e be300 vmlinux</b>
      <p>
      <li><a href="http://www.disorder.ru/openbsd/be300/">OpenBSD/be300</a>:
	<br><a href="http://www.disorder.ru/openbsd/be300/bsd.rd">http://www.disorder.ru/openbsd/be300/bsd.rd</a>
	<br>Try <b>./mips64emul -X -b -E hpc -e be300 bsd.rd</b>
	<br>Note: -b might be buggy, so you can try without that if you want to.
    </ul>
  </li>

  <p>

  <li><a href="http://www.meshcube.org/">MeshCube</a>:
    <ul>
      <li>Linux:
	<br>A Linux kernel is available from
	<a href="http://www.meshcube.org/feed/stable/">http://www.meshcube.org/feed/stable</a>/<a href="http://www.meshcube.org/feed/stable/kernel-image-mtx_2.4.24-3_mipsel.ipk">kernel-image-mtx_2.4.24-3_mipsel.ipk</a>
	<br>(This is a Debian package, you can use <b>ar</b> and <b>tar</b>
		to extract kernel.img from it.)
	<br>Try running with <b>-E meshcube 0x80800000:kernel.img</b>.
    </ul>
  </li>

  <p>

  <li><a href="http://www.seattlewireless.net/index.cgi/NetgearWG602">NetGear WG602</a>:
    <ul>
      <li>Linux:
	<br>A Linux kernel is available from
	<a href="ftp://downloads.netgear.com/files/wg602_v1715.zip">ftp://downloads.netgear.com/files/wg602_v1715.zip</a>
	<br>(Unzip wg602_v1715.zip to get WG602_V1715.img.)
	<br>Try running with <b>-E netgear 0xbfc80000:0x40:WG602_V1715.img</b>.
	<br>(It takes some time to decompress the kernel, so be patient.)
    </ul>
  </li>

  <p>

  <li>Linksys WRT54G:
    <ul>
      <li>Linux:
	<br><a href="http://openwrt.org/">OpenWRT</a> is a Linux
		distribution for the WRT54G.
	<br><a href="http://www.batbox.org/wrt54g-linux.html">BatBox</a>
		is another distribution.
	<br>Download <a href="http://pjf.dotgeek.org/downloads/openwrt/openwrt-g-code.bin">http://pjf.dotgeek.org/downloads/openwrt/openwrt-g-code.bin</a>
		(or a similar .bin file).
	<br>From offset 60 and forward in the bin file, there is a gzip file.
	<br>$ <b>dd if=openwrt-g-code.bin of=piggy.gz bs=60 iseek=1 oseek=0</b>
	<br>$ <b>gunzip piggy.gz</b>
	<br>$ <b>./mips64emul -E linksys -t 0x80001000:piggy</b>
	<br>There's also a .bin file available from linksys:
		<a href="ftp://ftp.linksys.com/pub/network/WRT54G_1.30.7_US_code.bin">ftp://ftp.linksys.com/pub/network/WRT54G_1.30.7_US_code.bin</a>
    </ul>
  </li>
</ul>

<p>
The following don't work at all, actually, because the PPC and SPARC
modes are just skeletons so far. (To enable PPC and/or SPARC support, add
--enable-ppc and --enable-sparc to the configure command line, respectively.)

<p>
<ul>

  <li>Walnut (evbppc):
    <ul>
      <li><a href="http://www.netbsd.org/Ports/evbppc/">NetBSD/evbppc</a>:
	<br><a href="ftp://ftp.netbsd.org/pub/NetBSD/NetBSD-2.0/evbppc/binary/kernel/netbsd-INSTALL_WALNUT.gz">ftp://ftp.netbsd.org/pub/NetBSD/NetBSD-2.0/evbppc/binary/kernel/netbsd-INSTALL_WALNUT.gz</a>
	<br>gunzip, and try the following:
	<br>$ <b>./mips64emul -E walnut -v -t netbsd-INSTALL_WALNUT</b>
    </ul>
  </li>

  <p>

  <li>Artesyn's PM/PPC board (pmppc):
    <ul>
      <li><a href="http://www.netbsd.org/Ports/pmppc/">NetBSD/pmppc</a>:
	<br><a href="ftp://ftp.netbsd.org/pub/NetBSD/NetBSD-2.0/pmppc/binary/kernel/netbsd-INSTALL.gz">ftp://ftp.netbsd.org/pub/NetBSD/NetBSD-2.0/pmppc/binary/kernel/netbsd-INSTALL.gz</a>
	<br>gunzip, and try the following:
	<br>$ <b>./mips64emul -E pmppc netbsd-INSTALL</b>
    </ul>
  </li>

  <p>

  <li>Motorola Sandpoint (sandpoint):
    <ul>
      <li><a href="http://www.netbsd.org/Ports/sandpoint/">NetBSD/sandpoint</a>:
	<br><a href="ftp://ftp.netbsd.org/pub/NetBSD/NetBSD-2.0/sandpoint/binary/kernel/netbsd-INSTALL.gz">ftp://ftp.netbsd.org/pub/NetBSD/NetBSD-2.0/sandpoint/binary/kernel/netbsd-INSTALL.gz</a>
	<br>gunzip, and try the following:
	<br>$ <b>./mips64emul -E sandpoint -v -t netbsd-INSTALL</b>
    </ul>
  </li>

  <p>

  <li>PReP:
    <ul>
      <li><a href="http://www.netbsd.org/Ports/prep/">NetBSD/prep</a>:
	<br><a href="ftp://ftp.netbsd.org/pub/NetBSD/NetBSD-2.0/prep/binary/kernel/netbsd-INSTALL.gz">ftp://ftp.netbsd.org/pub/NetBSD/NetBSD-2.0/prep/binary/kernel/netbsd-INSTALL.gz</a>
	<br>gunzip, and try the following:
	<br>$ <b>./mips64emul -E prep -v -t netbsd-INSTALL</b>
      <p>
      <li>Linux:
	<br><a href="http://jocelyn.mayer.free.fr/qemu-ppc/linux_images/2.4.25-PPC/vmlinux">http://jocelyn.mayer.free.fr/qemu-ppc/linux_images/2.4.25-PPC/vmlinux</a>
	<br>$ <b>./mips64emul -E prep -v -t vmlinux</b>
    </ul>
  </li>

  <p>

  <li>MacPPC:
    <ul>
      <li><a href="http://www.netbsd.org/Ports/macppc/">NetBSD/macppc</a>:
	<br>..
      <p>
      <li><a href="http://www.openbsd.org/macppc.html">OpenBSD/macppc</a>:
	<br>..
    </ul>
  </li>

  <p>

  <li>BeBox:
    <ul>
      <li><a href="http://www.netbsd.org/Ports/bebox/">NetBSD/bebox</a>:
	<br><a href="ftp://ftp.netbsd.org/pub/NetBSD/arch/bebox/snapshot/19981119/kern.tgz">ftp://ftp.netbsd.org/pub/NetBSD/arch/bebox/snapshot/19981119/kern.tgz</a>
	<br>$ <b>tar tvzf kern.tgz</b>
	<br>$ <b>./mips64emul -E bebox netbsd</b>
      <p>
      <li><a href="http://www.bebox.nu/os.php?s=os/linux/index">Linux/bebox</a>:
	<br><a href="http://www.bebox.nu/files/linux/BeBox-scsi-980610.gz">http://www.bebox.nu/files/linux/BeBox-scsi-980610.gz</a>
	<br>$ <b>gunzip BeBox-scsi-980610.gz</b>
	<br>$ <b>./mips64emul -E bebox 0x3100:0x400:BeBox-scsi-980610</b>
    </ul>
  </li>

  <p>

  <li>SPARC64:
    <ul>
      <li><a href="http://www.netbsd.org/Ports/sparc64/">NetBSD/sparc64</a>:
	<br><a href="ftp://ftp.netbsd.org/pub/NetBSD/NetBSD-2.0/sparc64/binary/kernel/netbsd-INSTALL.gz">ftp://ftp.netbsd.org/pub/NetBSD/NetBSD-2.0/sparc64/binary/kernel/netbsd-INSTALL.gz</a>
	<br>gunzip, and try the following:
	<br>$ <b>./mips64emul -E ultra1 -v -i netbsd-INSTALL</b>
      <p>
      <li><a href="http://www.openbsd.org/sparc64.html">OpenBSD/sparc64</a>:
	<br><a href="ftp://ftp.openbsd.org/pub/OpenBSD/3.6/sparc64/bsd.rd">ftp://ftp.openbsd.org/pub/OpenBSD/3.6/sparc64/bsd.rd</a>
	<br>rename to bsd.rd.gz, gunzip, and try the following:
	<br>$ <b>./mips64emul -E ultra1 -v -i bsd.rd</b>
    </ul>
  </li>
</ul>

<p>
The URISC emulation mode is just for fun. Enable with the --enable-urisc 
configure option. (Read <a href="http://en.wikipedia.org/wiki/URISC">http://en.wikipedia.org/wiki/URISC</a>
for more info.)

<p>
<ul>

  <li>URISC:
    <ul>
      <li>I've placed a small test program in the experiments directory.
	<br>Start like this: <b>./mips64emul -E testurisc 0:urisc_test.bin</b>
	<br>or, if you want to single-step:
		<b>./mips64emul -V -E testurisc 0:urisc_test.bin</b>
	<br>2005-03-01: All outputed characters are printed twice. I'll
	try to make a pseudo-device for outputing to "normal" devices
	later.
    </ul>
  </li>

</ul>






</p>

</body>
</html>
